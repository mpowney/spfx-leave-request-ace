/*! For license information please see leave-request-adaptive-card-extension_ca3d4c9dbe53d69d19cf.js.LICENSE.txt */
define("12a66bcf-5f0b-4ad8-aa43-5cc67f668912_0.0.1",["LeaveRequestAdaptiveCardExtensionStrings","@microsoft/sp-loader","@microsoft/sp-adaptive-card-extension-base"],function(n,a,i){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={1:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){return{0:[{i:"f9e737b7-f0df-4597-ba8c-3060f82380db",v:"1.14.0",m:"26ea"}]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({0:"LeaveRequest-property-pane"}[e]||e)+"_"+{0:"94d2f7f5863b7dc5ba06"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp_12a66bcf_5f0b_4ad8_aa43_5cc67f668912_0_0_1=window.webpackJsonp_12a66bcf_5f0b_4ad8_aa43_5cc67f668912_0_0_1||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n=/leave-request-adaptive-card-extension_ca3d4c9dbe53d69d19cf\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="qtCP")}({"01A+":function(e){e.exports=JSON.parse('{"schema":"http://adaptivecards.io/schemas/adaptive-card.json","type":"AdaptiveCard","version":"1.3","body":[{"type":"TextBlock","weight":"Bolder","text":"${strings.CommonLeaveBalances}"},{"type":"FactSet","$data":"${leaveBalances}","facts":[{"title":"${leaveTypeLabel}","value":"${leaveBalance}"}]},{"type":"TextBlock","separator":true,"weight":"Bolder","text":"${strings.CommonLeaveRequest}"},{"type":"Input.Date","id":"leaveStartDate","label":"${strings.CommonStartDate}","value":"${leaveStartDate}","isRequired":true,"errorMessage":"${strings.CommonPleaseSelectADate}","placeholder":"${strings.CommonSelectDate}"},{"type":"Input.Date","isRequired":true,"errorMessage":"${strings.CommonPleaseSelectADate}","label":"${strings.CommonReturnToWork}","value":"${leaveFinishDate}","id":"leaveFinishDate","placeholder":"${strings.CommonSelectDate}"},{"type":"Input.Number","label":"${strings.CommonCalculatedHours}","id":"leaveCalculatedHours","placeholder":"${strings.PhraseThisWillBeFilledWhen}","min":0,"value":"${leaveCalculatedHours}","$when":"${leaveCalculatedHours > 0}"}],"actions":[{"type":"Action.Submit","title":"${strings.CommonCalculateHours}","verb":"calculateHours","data":{"id":"calculateHours"}},{"type":"Action.Submit","title":"${strings.CommonSubmitForApproval}","verb":"submitForApproval","data":{"id":"submitForApproval"},"$when":"${$root.leaveCalculatedHours > 0}","isEnabled":"${$root.submitting == false}"}]}')},BDjR:function(e,t){e.exports=n},I6O9:function(e,t){e.exports=a},KfPa:function(e,t,n){e.exports=n.p+"suitcase_81788b79063b339e2ede689a02279211.png"},"lz/E":function(e,t){e.exports=i},qtCP:function(e,t,n){"use strict";n.r(t),n.d(t,"QUICK_VIEW_REGISTRY_ID",function(){return at});var a,i=n("lz/E"),r=n("BDjR"),o=(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),Object.defineProperty(t.prototype,"cardButtons",{get:function(){return this.state.loading?void 0:[{title:r.CommonRequestLeave,action:{type:"QuickView",parameters:{view:at}}}]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){var e=n("KfPa"),t="https://raw.githubusercontent.com/microsoft/fluentui-system-icons/master/assets/Brightness%20High/SVG/ic_fluent_brightness_high_24_regular.svg";return this.state.loading?{primaryText:r.PhraseLookingUpYourAnnualLeave,imageUrl:e,iconProperty:t,title:r.CommonLeaveRequest}:this.state.annualLeaveBalance&&this.state.annualLeaveBalance>0?{primaryText:(this.state.unnapprovedAnnualLeaveBalance||0)>0?r.PhraseYouHaveHoursAnnualLeaveWithUnapproved.replace("{0}",""+this.state.annualLeaveBalance).replace("{1}",""+(this.state.unnapprovedAnnualLeaveBalance||0)):r.PhraseYouHaveHoursAnnualLeave.replace("{0}",""+this.state.annualLeaveBalance),imageUrl:e,iconProperty:t,title:r.CommonLeaveRequest}:{primaryText:r.PhraseCannotFindAnyAnnualLeave,imageUrl:e,iconProperty:t,title:r.CommonLeaveRequest}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCardSelection",{get:function(){return this.state.loading?void 0:{type:"QuickView",parameters:{view:at}}},enumerable:!1,configurable:!0}),t}(i.BaseImageCardView);const c=["verbose","info","warning","error"];class d{constructor(e="",t={}){this._prefix=e,this._colors=t}log(e){var t,n;t=function(e,t){const n=[];if(t.length>0&&n.push(`${t} -`),n.push(e.message),void 0!==e.data)try{n.push("Data: "+JSON.stringify(e.data))}catch(e){n.push(`Data: Error in stringify of supplied data ${e}`)}return n.join(" ")}(e,this._prefix),void 0===(n=this._colors[c[e.level]])?console.log(t):console.log(`%c${t}`,`color:${n}`)}}var l;!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(l||(l={}));const u=[];let f=2;class p{static get activeLogLevel(){return f}static set activeLogLevel(e){f=e}static subscribe(...e){u.push(...e)}static clearSubscribers(){const e=u.slice(0);return u.length=0,e}static get count(){return u.length}static write(e,t=1){p.log({level:t,message:e})}static writeJSON(e,t=1){p.write(JSON.stringify(e),t)}static log(e){void 0!==e&&p.activeLogLevel<=e.level&&u.map(t=>t.log(e))}static error(e){p.log({data:e,level:3,message:e.message})}}function m(e,t,n){let a=new Date(e.toString());switch(t.toLowerCase()){case"year":a.setFullYear(a.getFullYear()+n);break;case"quarter":a.setMonth(a.getMonth()+3*n);break;case"month":a.setMonth(a.getMonth()+n);break;case"week":a.setDate(a.getDate()+7*n);break;case"day":a.setDate(a.getDate()+n);break;case"hour":a.setTime(a.getTime()+36e5*n);break;case"minute":a.setTime(a.getTime()+6e4*n);break;case"second":a.setTime(a.getTime()+1e3*n);break;default:a=void 0}return a}function _(...e){return e.filter(e=>!v(e)).map(e=>e.replace(/^[\\|/]/,"").replace(/[\\|/]$/,"")).join("/").replace(/\\/g,"/")}function h(e){return"function"==typeof e}function b(e){return Array.isArray(e)}function g(e){return/^https?:\/\/|^\/\//i.test(e)}function v(e){return null==e||e.length<1}function y(e){return null!=e}function S(e){return JSON.stringify(e)}function D(e,t){return Object.hasOwnProperty.call(e,t)}function I(){return function(e,...t){const n=[...e];for(let e=0;e<n.length;e++)Reflect.apply(n[e],this,t)}}function x(){return async function(e,...t){let n=t;const a=[...e];for(let e=0;e<a.length;e++)n=await Reflect.apply(a[e],this,n);return n}}function C(e,t,n,a){if(!h(n))throw Error("Observers must be functions.");if(Reflect.has(e,t))switch(a){case"add":e[t].push(n);break;case"prepend":e[t].unshift(n);break;case"replace":e[t].length=0,e[t].push(n)}else e[t]=[n];return e[t]}let O=!1;const w=Symbol.for("PnPExt"),E=new Map;function A(e,t,n,...a){if(O){const t=[];let i;Reflect.has(n,w)&&t.push(...Reflect.get(n,w));for(let r=0;r<t.length;r++){const o=t[r];if(h(o)?i=o(e,n,...a):"get"===e&&Reflect.has(o,a[0])?i=Reflect.get(o,a[0],n):Reflect.has(o,e)&&(i=Reflect.get(o,e)(n,...a)),void 0!==i)return i}}return t(n,...a)}function L(e,t,n,a){Reflect.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get:function(){return n(this,a||t)}})}function k(e,t={headers:{}}){return{method:e,...t,headers:{...t.headers}}}function M(e){return this.start(k("GET",e))}function P(e){return this.start(k("POST",e))}function T(e,t,n){return Reflect.apply(t,e,[n])}Object.create,Object.create;const U={pre:x(),auth:x(),send:async function(e,...t){if(!b(e)||e.length<1)return;const n=e[0];return await Reflect.apply(n,this,t)},parse:x(),post:x(),data:I()};let F=class extends class{constructor(e,t={}){this.moments=e,this.observers=t,this._onProxy=null,this._emitProxy=null,this._inheritingObservers=!0}using(...e){for(let t=0;t<e.length;t++)e[t](this);return this}get on(){return null===this._onProxy&&(this._onProxy=new Proxy(this,{get:(e,t)=>Object.assign(n=>(e.cloneObserversOnChange(),C(e.observers,t,n,"add"),e),{toArray:()=>Reflect.has(e.observers,t)?[...Reflect.get(e.observers,t)]:[],replace:n=>(e.cloneObserversOnChange(),C(e.observers,t,n,"replace"),e),prepend:n=>(e.cloneObserversOnChange(),C(e.observers,t,n,"prepend"),e),clear:()=>!!Reflect.has(e.observers,t)&&(e.cloneObserversOnChange(),e.observers[t].length=0,!0)})})),this._onProxy}log(e,t=0){this.emit.log(e,t)}error(e){y(e)&&this.emit.error(e)}get emit(){return null===this._emitProxy&&(this._emitProxy=new Proxy(this,{get:(e,t)=>(...n)=>{const a=Reflect.has(e.observers,t)?Reflect.get(e.observers,t):[];if((!b(a)||a.length<1)&&"error"===t)throw Error(`Unhandled Exception: ${n[0]}`);try{const i=Reflect.has(e.moments,t)?Reflect.get(e.moments,t):"init"===t||"dispose"===t?function(e){const t=[...e];for(let e=0;e<t.length;e++)Reflect.apply(t[e],this,[]);return this}:I();return Reflect.apply(i,e,[a,...n])}catch(e){if("error"===t)throw e;this.error(e)}}})),this._emitProxy}async start(e){try{return this.emit.init(),await this.execute(e)}finally{try{this.emit.dispose()}catch(e){const t=Object.assign(Error("Error in dispose."),{innerException:e});this.error(t)}}}cloneObserversOnChange(){var e;this._inheritingObservers&&(this._inheritingObservers=!1,this.observers=(e=this.observers,Reflect.ownKeys(e).reduce((t,n)=>(t[n]=[...e[n]],t),{})))}}{constructor(e,t){super(U),this.InternalResolveEvent=Symbol.for("Queryable_Resolve"),this.InternalRejectEvent=Symbol.for("Queryable_Reject");let n,a="";if("string"==typeof e)a=_(e,t);else if(b(e)){if(2!==e.length)throw Error("When using the tuple first param only two arguments are supported");const i=e[0];a=_(e[1],t),n=i.observers}else{const{_url:i,observers:r}=e;a=_(i,t),n=r}void 0!==n&&(this.observers=n,this._inheritingObservers=!0),this._url=a,this._query=new Map}concat(e){return this._url+=e,this}toRequestUrl(){let e=this.toUrl();return this._query.size>0&&(e+="?"+Array.from(this._query).map(e=>`${e[0]}=${encodeURIComponent(e[1])}`).join("&")),e}get query(){return this._query}toUrl(){return this._url}execute(e){return setTimeout(async()=>{const t=function(){let e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}();let n;const a=(e,n)=>{this.log(`[${t}] ${e}`,n)};try{a("Beginning request",1);let[t,i,r]=await this.emit.pre(this.toRequestUrl(),e||{},void 0);if(a(`Url: ${t}`,1),void 0!==r)return a("Result returned from pre, Emitting data"),this.emit.data(r),void a("Emitted data");a("Emitting auth"),[n,i]=await this.emit.auth(new URL(t),i),a("Emitted auth"),i={...i,...e,headers:{...i.headers,...e.headers}},a("Emitting send");let o=await this.emit.send(n,i);a("Emitted send"),a("Emitting parse"),[n,o,r]=await this.emit.parse(n,o,r),a("Emitted parse"),a("Emitting post"),[n,r]=await this.emit.post(n,r),a("Emitted post"),a("Emitting data"),this.emit.data(r),a("Emitted data")}catch(e){a(`Emitting error: "${e.message||e}"`,3),this.error(e),a("Emitted error",3)}finally{a("Finished request",1)}},0),new Promise((e,t)=>{this.on[this.InternalResolveEvent].replace(e),this.on[this.InternalRejectEvent].replace(t)})}};var H;function R(e,t){return Object.assign({body:S(e)},t)}function N(e,t){return Object.assign({headers:e},t)}async function B(e,t,n){if(!t.ok)throw await z.init(t);return[e,t,n]}function j(e){let t=e;return D(e,"d")?t=D(e.d,"results")?e.d.results:e.d:D(e,"value")&&(t=e.value),t}function V(e){return t=>(t.on.parse.replace(B),t.on.parse(async(t,n,a)=>(void 0===a&&(a=await e(n)),[t,n,a])),t)}F=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}([e=>new Proxy(e,{construct(t,n,a){let i=Reflect.construct(t,n,a);const r=Reflect.getPrototypeOf(e);if(Reflect.has(r,w)){const e=E.get(Reflect.get(r,w));e&&(i=function(e,t){return O=!0,Reflect.has(e,w)||Reflect.set(e,w,[]),n=Reflect.get(e,w),b(a=t)?n.push(...a):n.push(a),e;var n,a}(i,e))}const o=new Proxy(i,{apply:(e,t,n)=>A("apply",(...e)=>Reflect.apply(...e),e,o,n),get:(e,t,n)=>A("get",(...e)=>Reflect.get(...e),e,t,n),has:(e,t)=>A("has",(...e)=>Reflect.has(...e),e,t),set:(e,t,n,a)=>A("set",(...e)=>Reflect.set(...e),e,t,n,a)});return o}}),("function"!=typeof H&&(H=function(e){return T(this,M,e)}),e=>new Proxy(e,{construct(e,t,n){const a=Object.assign(function(e){const t=void 0===this?a:this;return Reflect.apply(H,t,[e])},Reflect.construct(e,t,n));return Reflect.setPrototypeOf(a,n.prototype),a}}))],F);class z extends Error{constructor(e,t,n=t.status,a=t.statusText){super(e),this.response=t,this.status=n,this.statusText=a,this.isHttpRequestError=!0}static async init(e){const t=await e.clone().text();return new z(`Error making HttpClient request in queryable [${e.status}] ${e.statusText} ::> ${t}`,e.clone())}}const G=(e,t)=>T(e,P,t),K=(e,t)=>((t=t||{}).headers={...t.headers,"X-HTTP-Method":"MERGE"},G(e,t)),W=(e,t)=>((t=t||{}).headers={...t.headers||{},"X-HTTP-Method":"DELETE"},G(e,t)),q=e=>{return t=e,(e,n)=>new t(e,n);var t};class Q extends F{constructor(e,t){if("string"==typeof e){let n="",a="";if(g(e)||e.lastIndexOf("/")<0)a=e,n=_(e,t);else if(e.lastIndexOf("/")>e.lastIndexOf("(")){const i=e.lastIndexOf("/");a=e.slice(0,i),t=_(e.slice(i),t),n=_(a,t)}else{const i=e.lastIndexOf("(");a=e.slice(0,i),n=_(e,t)}super(n),this.parentUrl=a}else{super(e,t);const n=b(e)?e[0]:e;this.parentUrl=n.toUrl();const a=n.query.get("@target");void 0!==a&&this.query.set("@target",a)}}toRequestUrl(){const e=new Map(this.query);let t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,(t,n,a)=>(this.log(`Rewriting aliased parameter from match ${t} to label: ${n} value: ${a}`,0),e.set(n,`'${a}'`),n));if(e.size>0){const n=t.indexOf("?")>-1?"&":"?";t+=`${n}${Array.from(e).map(e=>e[0]+"="+e[1]).join("&")}`}return t}select(...e){return e.length>0&&this.query.set("$select",e.map(encodeURIComponent).join(",")),this}expand(...e){return e.length>0&&this.query.set("$expand",e.map(encodeURIComponent).join(",")),this}getParent(e,t,n=this.parentUrl){const a=e([this,n],t),i="@target";return this.query.has(i)&&a.query.set(i,this.query.get(i)),a}}const Y=q(Q);class J extends Q{filter(e){return this.query.set("$filter",encodeURIComponent(e)),this}orderBy(e,t=!0){const n="$orderby",a=this.query.has(n)?this.query.get(n).split(","):[];return a.push(`${encodeURIComponent(e)} ${t?"asc":"desc"}`),this.query.set(n,a.join(",")),this}skip(e){return this.query.set("$skip",e.toString()),this}top(e){return this.query.set("$top",e.toString()),this}}const X=q(J);class Z extends Q{}const $=q(Z);function ee(){return function(){return W(this)}}function te(){return function(e="*"){return((e,t,n="*")=>((t=t||{}).headers={...t.headers||{},"IF-Match":n},W(e,t)))(this,{},e)}}function ne(e){return function(t){return class extends t{constructor(...t){super(t[0],t.length>1&&void 0!==t[1]?t[1]:e)}}}}class ae{constructor(e=""){this._root=Y(e)}using(...e){return this._root.using(...e),this}create(e,t){return e(this._root,t)}}function ie(e=""){return"object"!=typeof e||Reflect.has(e,"length")||(e=e._root),new ae(e)}var re,oe,se;function ce(e){return v(e)?"":/!(@.*?)::(.*?)/gi.test(e)?e.replace(/!(@.*?)::(.*)$/gi,(e,t,n)=>`!${t}::${encodeURIComponent(n.replace(/'/gi,"''"))}`):encodeURIComponent(e.replace(/'/gi,"''"))}function de(e){if(v(e))return"";let t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substr(0,t):e}function le(e){const t=[],n=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];if(D(e,n[0])&&"SP.Web"===e[n[0]])D(e,n[4])?t.push(e[n[4]]):D(e,n[2])&&t.push(e.__metadata.uri);else if(D(e,n[3])&&D(e,n[1])){const a=g(e[n[1]])?e[n[1]].split("_api")[1]:e[n[1]];t.push(de(e[n[3]]),"_api",a)}else D(e,n[1])?t.push("_api",e[n[1]]):D(e,n[2])&&t.push(e.__metadata.uri);return t.length<1?"":_(...t)}function ue(e){const t=new Date;return!y(e)||t>e.expiration?null:e}!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(re||(re={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(oe||(oe={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(se||(se={}));const fe=new Map;function pe(e){return t=>{return t.using(e=>(e.using(function(e){return t=>(t.on.pre(async function(t,n,a){return n.headers={...n.headers,...e},[t,n,a]}),t)}({Accept:"application/json","Content-Type":"application/json;charset=utf-8"})),e),e=>(e.on.pre(async(e,t,n)=>(t.cache="no-cache",t.credentials="same-origin",[e,t,n])),e.using(e=>(e.on.pre(async function(e,t,n){let a="PnPCoreJS:3.2.0:";const{pathname:i}=new URL(e);return a+=i.substring(i.indexOf("_api/")+5).split("/").map((e,t,n)=>t===n.length-1?e:e[0]).join("."),a.length>32&&(a=a.substring(0,32)),this.log(`Request Tag: ${a}`,0),t.headers={...t.headers,"X-ClientService-ClientTag":a},[e,t,n]}),e),e=>(e.on.error(function(e){this.emit[this.InternalRejectEvent](e)}),e),e=>(e.on.data(function(e){this.emit[this.InternalResolveEvent](e)}),e)),e),function(e){const{interval:t,replace:n,retries:a}={replace:!0,interval:200,retries:3};return e=>(n&&e.on.send.clear(),e.on.send(function(e,n){let i,r=t,o=1;const s=async()=>{if(o>=a)throw new z(`Retry count exceeded (${a}) for this request. ${i.status}: ${i.statusText};`,i);if(void 0!==i&&429!==(null==i?void 0:i.status)&&503!==(null==i?void 0:i.status)&&504!==(null==i?void 0:i.status))return i;void 0!==i&&(i.headers.has("Retry-After")?r=1e3*parseInt(i.headers.get("Retry-After"),10):r*=2,this.log(`Attempt #${o} to retry request which failed with ${i.status}: ${i.statusText}`,0),o++,await(t=r,new Promise(e=>{setTimeout(e,t)})));try{const t=e.toString();return this.log(`Fetch: ${n.method} ${t}`,0),i=await fetch(t,n),i.ok?i:s()}catch(e){return s()}var t};return s()}),e)}(),V(async e=>{if(e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status)return{};const t=await e.text();return j(t.replace(/\s/gi,"").length>0?JSON.parse(t):{})}),(n=t=>{var n,a,i;if(new RegExp(`^${_(e.pageContext.web.absoluteUrl,"/_api")}`,"i").test(t)&&(null===(a=null===(n=null==e?void 0:e.pageContext)||void 0===n?void 0:n.legacyPageContext)||void 0===a?void 0:a.formDigestValue))return{value:e.pageContext.legacyPageContext.formDigestValue,expiration:m(new Date,"second",(null===(i=e.pageContext.legacyPageContext)||void 0===i?void 0:i.formDigestTimeoutSeconds)||1600)}},e=>(e.on.pre(async function(e,t,a){return/get/i.test(t.method)||t.headers&&(D(t.headers,"X-RequestDigest")||D(t.headers,"Authorization"))||this.on.auth(async(e,t)=>{const a=e.toString(),i=de(a);let r=ue(fe.get(i));return y(r)||(r=ue(n(a))),y(r)||(r=await fetch(_(i,"/_api/contextinfo"),{cache:"no-cache",credentials:"same-origin",headers:{accept:"application/json","content-type":"application/json;odata=verbose;charset=utf-8"},method:"POST"}).then(e=>e.json()).then(e=>({expiration:m(new Date,"second",e.FormDigestTimeoutSeconds),value:e.FormDigestValue}))),y(r)&&(t.headers={"X-RequestDigest":r.value,...t.headers},fe.set(i,r)),[e,t]}),[e,t,a]}),e))),t.on.pre.prepend(async(t,n,a)=>(g(t)||(t=_(e.pageContext.web.absoluteUrl,t)),[t,n,a])),t;var n}}function me(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}Object.create,Object.create;let _e=class extends J{async add(e,t,n="",a="STS",i=1033,r=!0){const o=R({parameters:{Description:n,Language:i,Title:e,Url:t,UseSamePermissionsAsParentSite:r,WebTemplate:a}}),s=await G(he(this,"add"),o);return{data:s,web:ve([this,le(s).replace(/_api\/web\/?/i,"")])}}};_e=me([ne("webs")],_e);const he=q(_e);function be(e,t){let n="_api/web";const a=/(_api[/|\\](site|web))/i.exec(e);return(null==a?void 0:a.length)>0&&(e=de(e),n=a[1]),(null==t?void 0:t.indexOf("_api"))<0&&(e=_(e,n)),e}let ge=class extends Z{constructor(e,t){super(e="string"==typeof e?be(e,t):b(e)?[e[0],be(e[1],t)]:[e,be(e.toUrl(),t)],t),this.delete=ee()}get webs(){return he(this)}get allProperties(){return $(this,"allproperties")}get webinfos(){return X(this,"webinfos")}async getParentWeb(){const{Url:e,ParentWeb:t}=await this.select("Url","ParentWeb/ServerRelativeUrl").expand("ParentWeb")();return(null==t?void 0:t.ServerRelativeUrl)?ve([this,e.substring(0,e.indexOf(t.ServerRelativeUrl)+t.ServerRelativeUrl.length)]):null}async update(e){return K(this,R(e))}applyTheme(e,t,n,a){const i=R({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:a});return G(ve(this,"applytheme"),i)}applyWebTemplate(e){return G(ve(this,`applywebtemplate(webTemplate='${ce(e)}')`))}getChanges(e){return G(ve(this,"getchanges"),R({query:e}))}mapToIcon(e,t=0,n=""){return ve(this,`maptoicon(filename='${ce(e)}',progid='${ce(n)}',size=${t})`)()}getStorageEntity(e){return ve(this,`getStorageEntity('${ce(e)}')`)()}setStorageEntity(e,t,n="",a=""){return G(ve(this,"setStorageEntity"),R({comments:a,description:n,key:e,value:t}))}removeStorageEntity(e){return G(ve(this,`removeStorageEntity('${ce(e)}')`))}getSubwebsFilteredForCurrentUser(e=-1,t=-1){return X(this,`getSubwebsFilteredForCurrentUser(nWebTemplateFilter=${e},nConfigurationFilter=${t})`)}availableWebTemplates(e=1033,t=!0){return X(this,`getavailablewebtemplates(lcid=${e},doincludecrosslanguage=${t})`)}};ge=me([ne("_api/web")],ge);const ve=q(ge);function ye(e){return{DecodedUrl:e}}Reflect.defineProperty(ae.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return this.create(ve)}});let Se=class extends J{getById(e){return xe(this).concat(`('${e}')`)}getByTitle(e){return xe(this,`getByTitle('${ce(e)}')`)}async add(e,t="",n=100,a=!1,i={}){const r={AllowContentTypes:a,BaseTemplate:n,ContentTypesEnabled:a,Description:t,Title:e,...i};return{data:await G(this,R(r)),list:this.getByTitle(r.Title)}}async ensure(e,t="",n=100,a=!1,i={}){const r={Title:e,Description:t,ContentTypesEnabled:a,...i},o=this.getByTitle(r.Title);try{return await o.select("Title")(),{created:!1,data:await o.update(r).then(e=>e.data),list:this.getByTitle(r.Title)}}catch(i){return{created:!0,data:await this.add(e,t,n,a,r).then(e=>e.data),list:this.getByTitle(r.Title)}}}async ensureSiteAssetsLibrary(){const e=await G(De(this,"ensuresiteassetslibrary"));return xe(le(e))}async ensureSitePagesLibrary(){const e=await G(De(this,"ensuresitepageslibrary"));return xe(le(e))}};Se=me([ne("lists")],Se);const De=q(Se);class Ie extends Z{constructor(){super(...arguments),this.delete=te()}get effectiveBasePermissions(){return Y(this,"EffectiveBasePermissions")}get eventReceivers(){return X(this,"EventReceivers")}get relatedFields(){return Y(this,"getRelatedFields")}get informationRightsManagementSettings(){return Y(this,"InformationRightsManagementSettings")}async update(e,t="*"){return{data:await K(this,R(e,N({"IF-Match":t}))),list:D(e,"Title")?this.getParent(xe,`getByTitle('${e.Title}')`):xe(this)}}getChanges(e){return G(xe(this,"getchanges"),R({query:e}))}getItemsByCAMLQuery(e,...t){return G(xe(this,"getitems").expand(...t),R({query:e}))}getListItemChangesSinceToken(e){return G(xe(this,"getlistitemchangessincetoken").using(V(e=>e.text())),R({query:e}))}async recycle(){return G(xe(this,"recycle"))}async renderListData(e){const t=xe(this,"renderlistdata(@viewXml)");t.query.set("@viewXml",`'${e}'`);const n=await G(t);return JSON.parse(n)}renderListDataAsStream(e,t=null,n=new Map){D(e,"RenderOptions")&&b(e.RenderOptions)&&(e.RenderOptions=e.RenderOptions.reduce((e,t)=>e+t));const a=xe(this,"RenderListDataAsStream");n&&n.size>0&&n.forEach((e,t)=>a.query.set(t,e));const i=y(t)?{parameters:e,overrideParameters:t}:{parameters:e};return G(a,R(i))}async renderListFormData(e,t,n){const a=await G(xe(this,`renderlistformdata(itemid=${e}, formid='${t}', mode='${n}')`));return JSON.parse(a)}async reserveListItemId(){return G(xe(this,"reservelistitemid"))}async addValidateUpdateItemUsingPath(e,t,n=!1,a,i){const r={FolderPath:ye(t)};return y(i)&&(i.leafName&&(r.LeafName=ye(i.leafName)),i.objectType&&(r.UnderlyingObjectType=i.objectType)),G(xe(this,"AddValidateUpdateItemUsingPath()"),R({bNewDocumentUpdate:n,checkInComment:a,formValues:e,listItemCreateInfo:r}))}async getParentInfos(){const e=await this.select("Id","RootFolder/UniqueId","RootFolder/ServerRelativeUrl","RootFolder/ServerRelativePath","ParentWeb/Id","ParentWeb/Url","ParentWeb/ServerRelativeUrl","ParentWeb/ServerRelativePath").expand("RootFolder","ParentWeb")();return{List:{Id:e.Id,RootFolderServerRelativePath:e.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.RootFolder.UniqueId},ParentWeb:{Id:e.ParentWeb.Id,ServerRelativePath:e.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentWeb.ServerRelativeUrl,Url:e.ParentWeb.Url}}}}const xe=q(Ie);var Ce,Oe;!function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(Ce||(Ce={})),function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(Oe||(Oe={})),L(ge,"lists",De),L(ge,"siteUserInfoList",xe),L(ge,"defaultDocumentLibrary",xe),L(ge,"customListTemplates",X,"getcustomlisttemplates"),ge.prototype.getList=function(e){return xe(this,`getList('${ce(e)}')`)},ge.prototype.getCatalog=async function(e){const t=await ve(this,`getcatalog(${e})`).select("Id")();return xe(le(t))};let we=class extends J{getById(e){return Ae(this).concat(`(${e})`)}getItemByStringId(e){return Ae(this.parentUrl,`getItemByStringId('${e}')`)}skip(e,t=!1){return t?this.query.set("$skiptoken",encodeURIComponent(`Paged=TRUE&PagedPrev=TRUE&p_ID=${e}`)):this.query.set("$skiptoken",encodeURIComponent(`Paged=TRUE&p_ID=${e}`)),this}getPaged(){return this.using((e=this,V(async t=>{const n=await t.json(),a=D(n,"d")&&D(n.d,"__next")?n.d.__next:n["odata.nextLink"];return new Pe(e,a,j(n))})))();var e}async add(e={}){return G(this,R(e)).then(e=>({data:e,item:this.getById(e.Id)}))}};we=me([ne("items")],we);const Ee=q(we),Ae=q(class extends Z{constructor(){super(...arguments),this.delete=te()}get effectiveBasePermissions(){return Y(this,"EffectiveBasePermissions")}get effectiveBasePermissionsForUI(){return Y(this,"EffectiveBasePermissionsForUI")}get fieldValuesAsHTML(){return $(this,"FieldValuesAsHTML")}get fieldValuesAsText(){return $(this,"FieldValuesAsText")}get fieldValuesForEdit(){return $(this,"FieldValuesForEdit")}get versions(){return ke(this)}get list(){return this.getParent(xe,"",this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")))}async update(e,t="*"){const n=R(e,N({"IF-Match":t,"X-HTTP-Method":"MERGE"}));return{data:await G(Ae(this).using(V(async e=>({etag:e.headers.get("etag")}))),n),item:this}}recycle(){return G(Ae(this,"recycle"))}async deleteWithParams(e){return G(Ae(this,"DeleteWithParameters"),R({parameters:e}))}async getWopiFrameUrl(e=0){const t=Ae(this,"getWOPIFrameUrl(@action)");return t.query.set("@action",e),G(t)}validateUpdateListItem(e,t=!1){return G(Ae(this,"validateupdatelistitem"),R({formValues:e,bNewDocumentUpdate:t}))}async getParentInfos(){const e=await this.select("Id","ParentList/Id","ParentList/Title","ParentList/RootFolder/UniqueId","ParentList/RootFolder/ServerRelativeUrl","ParentList/RootFolder/ServerRelativePath","ParentList/ParentWeb/Id","ParentList/ParentWeb/Url","ParentList/ParentWeb/ServerRelativeUrl","ParentList/ParentWeb/ServerRelativePath").expand("ParentList","ParentList/RootFolder","ParentList/ParentWeb")();return{Item:{Id:e.Id},ParentList:{Id:e.ParentList.Id,Title:e.ParentList.Title,RootFolderServerRelativePath:e.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ParentList.ParentWeb.Id,ServerRelativePath:e.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ParentList.ParentWeb.Url}}}async setImageField(e,t,n){const a=await this.getParentInfos(),i=de(this.toUrl()),r=Y(i,"/_api/web/UploadImage");r.concat("(listTitle=@a1,imageName=@a2,listId=@a3,itemId=@a4)"),r.query.set("@a1",`'${ce(a.ParentList.Title)}'`),r.query.set("@a2",`'${ce(t)}'`),r.query.set("@a3",`'${ce(a.ParentList.Id)}'`),r.query.set("@a4",a.Item.Id);const o=await G(r,{body:n}),s={type:"thumbnail",fileName:o.Name,nativeFile:{},fieldName:e,serverUrl:a.ParentWeb.Url.replace(a.ParentWeb.ServerRelativeUrl,""),serverRelativeUrl:o.ServerRelativeUrl,id:o.UniqueId};return this.validateUpdateListItem([{FieldName:e,FieldValue:JSON.stringify(s)}])}});let Le=class extends J{getById(e){return Me(this).concat(`(${e})`)}};Le=me([ne("versions")],Le);const ke=q(Le),Me=q(class extends Z{constructor(){super(...arguments),this.delete=te()}});class Pe{constructor(e,t,n){this.parent=e,this.nextUrl=t,this.results=n}get hasNext(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0}async getNext(){return this.hasNext?Ee([this.parent,this.nextUrl],"").getPaged():null}}L(Ie,"items",Ee);let Te=class extends J{async createFieldAsXml(e){"string"==typeof e&&(e={SchemaXml:e});const t=await G(Ue(this,"createfieldasxml"),R({parameters:e}));return{data:t,field:this.getById(t.Id)}}getById(e){return Fe(this).concat(`('${e}')`)}getByTitle(e){return Fe(this,`getByTitle('${e}')`)}getByInternalNameOrTitle(e){return Fe(this,`getByInternalNameOrTitle('${e}')`)}async add(e,t,n){const a=await G(Ue(this,null),R({Title:e,FieldTypeKind:t,Required:n.Required||!1})),i=this.getById(a.Id);return void 0!==n&&await i.update(n),{data:await i(),field:i}}async addField(e,t,n){const a=await G(Ue(this,"AddField"),R({parameters:{Title:e,FieldTypeKind:t,...n}}));return{data:a,field:this.getById(a.Id)}}addText(e,t){return this.add(e,2,{MaxLength:255,...t})}addCalculated(e,t){return this.add(e,17,{OutputType:2,...t})}addDateTime(e,t){return this.add(e,4,{DateTimeCalendarType:1,DisplayFormat:Re.DateOnly,FriendlyDisplayFormat:Ne.Unspecified,...t})}addNumber(e,t){return this.add(e,9,{...t})}addCurrency(e,t){return this.add(e,10,{CurrencyLocaleId:1033,...t})}addMultilineText(e,t){return this.add(e,3,{AllowHyperlink:!0,AppendOnly:!1,NumberOfLines:6,RestrictedMode:!1,RichText:!0,...t})}addUrl(e,t){return this.add(e,11,{DisplayFormat:Ve.Hyperlink,...t})}addUser(e,t){return this.add(e,20,{SelectionMode:ze.PeopleAndGroups,...t})}async addLookup(e,t){return this.addField(e,7,t)}addChoice(e,t){return this.add(e,6,{EditFormat:Ge.Dropdown,FillInChoice:!1,...t})}addMultiChoice(e,t){return this.add(e,15,{FillInChoice:!1,...t})}addBoolean(e,t){return this.add(e,8,t)}async addDependentLookupField(e,t,n){const a=`adddependentlookupfield(displayName='${e}', primarylookupfieldid='${t}', showfield='${n}')`,i=await G(Ue(this,a));return{data:i,field:this.getById(i.Id)}}addLocation(e,t){return this.add(e,33,t)}addImageField(e,t){return this.add(e,34,t)}};Te=me([ne("fields")],Te);const Ue=q(Te),Fe=q(class extends Z{constructor(){super(...arguments),this.delete=ee()}async update(e,t){return null==t&&(t=(await Fe(this).select("FieldTypeKind")())["odata.type"]),{data:await K(this,R(e)),field:this}}setShowInDisplayForm(e){return G(Fe(this,`setshowindisplayform(${e})`))}setShowInEditForm(e){return G(Fe(this,`setshowineditform(${e})`))}setShowInNewForm(e){return G(Fe(this,`setshowinnewform(${e})`))}});var He,Re,Ne,Be,je,Ve,ze,Ge;!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(He||(He={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(Re||(Re={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Disabled=1]="Disabled",e[e.Relative=2]="Relative"}(Ne||(Ne={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(Be||(Be={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(je||(je={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(Ve||(Ve={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(ze||(ze={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(Ge||(Ge={})),L(ge,"fields",Ue),L(ge,"availablefields",Ue),L(Ie,"fields",Ue);var Ke,We=function(){function e(){}return e.LeaveBalanceListName="LeaveBalance",e.LeaveBalanceListDescription="This list is used for the SOCO SharePoint Leave Requests management system",e.LeaveBalanceFieldUser="LeaveUser",e.LeaveBalanceFieldType="LeaveType",e.LeaveBalanceFieldBalance="LeaveBalance",e.LeaveRequestListName="LeaveRequest",e.LeaveRequestListDescription="This list is used for the SOCO SharePoint Leave Requests management system",e.LeaveRequestFieldType="LeaveType",e.LeaveRequestFieldUser="LeaveUser",e.LeaveRequestFieldStart="LeaveStart",e.LeaveRequestFieldFinish="LeaveFinish",e.LeaveRequestFieldCalculatedAmount="LeaveCalculatedAmount",e.LeaveRequestFieldApproved="LeaveApproved",e}();!function(e){e.Annual="AnnualLeave",e.Sick="SickLeave",e.LongService="LongServiceLeave",e.CommunityService="CommunityServiceLeave",e.Parental="ParentalLeave",e.Family="FamilyLeave"}(Ke||(Ke={}));var qe=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},Qe=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},Ye=function(){function e(e){this.context=e,this.sp=ie().using(pe(e))}return e.prototype.checkProvisioned=function(){return qe(this,void 0,void 0,function(){var e;return Qe(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this.list?[2,!0]:[4,this.sp.web.lists.getByTitle(We.LeaveRequestListName)()];case 1:return t.sent()&&(this.list=this.sp.web.lists.getByTitle(We.LeaveRequestListName)),[2,!0];case 2:return e=t.sent(),p.log({level:3,message:"Error occurred in LeaveRequest checkForProvisioned with list title "+We.LeaveRequestListName,data:e}),[3,3];case 3:return[2,!1]}})})},e.prototype.ensureProvisioned=function(){return qe(this,void 0,void 0,function(){var e,t;return Qe(this,function(n){switch(n.label){case 0:return[4,this.checkProvisioned()];case 1:if(n.sent())return[3,13];p.log({level:1,message:"LeaveRequest ensureProvisioned - provisioning list "+We.LeaveRequestListName}),n.label=2;case 2:return n.trys.push([2,12,,13]),e={OnQuickLaunch:!1},[4,this.sp.web.lists.add(We.LeaveRequestListName,We.LeaveRequestListDescription,100,!1,e)];case 3:return n.sent(),[4,this.checkProvisioned()];case 4:return n.sent()?[4,this.list.fields.addChoice(We.LeaveRequestFieldType,{EditFormat:Ge.Dropdown,FillInChoice:!1,Choices:[Ke.Annual,Ke.Sick,Ke.Parental,Ke.Family,Ke.CommunityService,Ke.LongService]})]:[3,11];case 5:return n.sent(),[4,this.list.fields.addText(We.LeaveRequestFieldUser)];case 6:return n.sent(),[4,this.list.fields.addDateTime(We.LeaveRequestFieldStart)];case 7:return n.sent(),[4,this.list.fields.addDateTime(We.LeaveRequestFieldFinish)];case 8:return n.sent(),[4,this.list.fields.addNumber(We.LeaveRequestFieldCalculatedAmount)];case 9:return n.sent(),[4,this.list.fields.addBoolean(We.LeaveRequestFieldApproved,{Required:!1})];case 10:n.sent(),n.label=11;case 11:return[3,13];case 12:return t=n.sent(),p.log({level:3,message:"Error occurred in LeaveRequest ensureProvisioned with list title "+We.LeaveRequestListName,data:t}),[3,13];case 13:return[4,this.checkProvisioned()];case 14:return[2,n.sent()]}})})},e.prototype.ensureSampleData=function(){return qe(this,void 0,void 0,function(){return Qe(this,function(e){return[2,!0]})})},e.prototype.submitLeaveRequest=function(e,t,n,a,i){var r;return qe(this,void 0,void 0,function(){var o,s;return Qe(this,function(c){switch(c.label){case 0:return[4,this.checkProvisioned()];case 1:return c.sent()?[3,3]:(p.log({level:2,message:"LeaveRequest submitLeaveRequest - list not provisioned"}),[4,this.ensureProvisioned()]);case 2:c.sent(),c.label=3;case 3:return[4,this.list.items.add((s={Title:e+"-"+t+"-"+n.toISOString()},s[We.LeaveRequestFieldUser]=e,s[We.LeaveRequestFieldType]=t,s[We.LeaveRequestFieldStart]=n.toISOString(),s[We.LeaveRequestFieldFinish]=a.toISOString(),s[We.LeaveRequestFieldCalculatedAmount]=i,s[We.LeaveRequestFieldApproved]=!1,s))];case 4:return(o=c.sent()).data?[2,null===(r=o.data)||void 0===r?void 0:r.Id]:(p.log({level:3,message:"LeaveRequest submitLeaveRequest - failed to create request record"}),[2,0])}})})},e.prototype.getLeaveRequests=function(t,n,a){return qe(this,void 0,void 0,function(){var i,r;return Qe(this,function(o){switch(o.label){case 0:return[4,this.checkProvisioned()];case 1:return o.sent()?[3,3]:(p.log({level:2,message:"LeaveRequest getLeaveRequests - list not provisioned"}),[4,this.ensureProvisioned()]);case 2:o.sent(),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,this.list.items.filter(We.LeaveRequestFieldUser+" eq '"+t+"' and "+We.LeaveRequestFieldType+" eq '"+n+"' and "+We.LeaveRequestFieldApproved+" eq "+(a?1:0)).select(We.LeaveRequestFieldUser,We.LeaveRequestFieldType,We.LeaveRequestFieldStart,We.LeaveRequestFieldFinish,We.LeaveRequestFieldCalculatedAmount,We.LeaveRequestFieldApproved)()];case 4:return 0!==(i=o.sent()).length?[2,i.map(e.mapSPItem)]:(p.log({level:1,message:"LeaveRequest getLeaveRequests - no records for user "+t}),[3,6]);case 5:return r=o.sent(),p.log({level:3,message:"Error occurred in LeaveRequest getLeaveRequests with username "+t+", type "+n+", and approved "+a,data:r}),[3,6];case 6:return[2,[]]}})})},e.mapSPItem=function(e){return{username:e[We.LeaveRequestFieldUser],type:e[We.LeaveRequestFieldType],startDate:e[We.LeaveRequestFieldStart],finishDate:e[We.LeaveRequestFieldFinish],calculatedHours:e[We.LeaveRequestFieldCalculatedAmount],approved:e[We.LeaveRequestFieldApproved]}},e}(),Je=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Je(t,e),t.numberOfWeekdays=function(e,t){var n=(t.getTime()-e.getTime())/36e5/24,a=e.getTime(),i=0;do{var r=new Date(a).getDay();0!=r&&6!=r||i++,a+=864e5}while(a<t.getTime());return n-i},Object.defineProperty(t.prototype,"data",{get:function(){return p.log({level:0,message:"QuickView data() getter invoked",data:this.state}),{leaveBalances:[{leaveTypeLabel:r.CommonAnnualLeave,leaveBalance:this.state.annualLeaveBalance+" "+r.CommonHours}],leaveCalculatedHours:this.state.leaveCalculatedHours||0,leaveStartDate:""+this.state.leaveStartDate,leaveFinishDate:""+this.state.leaveFinishDate,submitting:this.state.submitting,strings:r}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"template",{get:function(){var e=n("01A+");return p.log({level:0,message:"QuickView template getter invoked",data:e}),e},enumerable:!1,configurable:!0}),t.prototype.onAction=function(e){var n,a,i,r,o;return i=this,void 0,o=function(){var i,r,o;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(s){switch(s.label){case 0:return p.log({level:0,message:"QuickView onAction() invoked",data:e}),"calculateHours"===(null===(n=e.data)||void 0===n?void 0:n.id)&&(r=new Date(e.data.leaveStartDate),o=new Date(e.data.leaveFinishDate),i=7.8*t.numberOfWeekdays(r,o),this.setState({leaveCalculatedHours:i,leaveStartDate:e.data.leaveStartDate,leaveFinishDate:e.data.leaveFinishDate})),"submitForApproval"!==(null===(a=e.data)||void 0===a?void 0:a.id)?[3,2]:(this.setState({submitting:!0}),r=new Date(e.data.leaveStartDate),o=new Date(e.data.leaveFinishDate),[4,new Ye(this.context).submitLeaveRequest(this.context.pageContext.user.loginName,Ke.Annual,r,o,e.data.leaveCalculatedHours)]);case 1:0!==s.sent()&&(this.setState({submitting:!1,submitted:!0,unnapprovedAnnualLeaveBalance:Number(this.state.unnapprovedAnnualLeaveBalance||0)+Number(e.data.leaveCalculatedHours),leaveStartDate:void 0,leaveFinishDate:void 0,leaveCalculatedHours:void 0}),this.quickViewNavigator.close()),s.label=2;case 2:return[2]}})},new((r=void 0)||(r=Promise))(function(e,t){function n(e){try{s(o.next(e))}catch(e){t(e)}}function a(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r(function(e){e(i)})).then(n,a)}s((o=o.apply(i,[])).next())})},t}(i.BaseAdaptiveCardView),Ze=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},$e=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},et=function(){function e(e){this.context=e,this.sp=ie().using(pe(e))}return e.prototype.checkProvisioned=function(){return Ze(this,void 0,void 0,function(){var e;return $e(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this.list?[2,!0]:[4,this.sp.web.lists.getByTitle(We.LeaveBalanceListName)()];case 1:return t.sent()&&(this.list=this.sp.web.lists.getByTitle(We.LeaveBalanceListName)),[2,!0];case 2:return e=t.sent(),p.log({level:3,message:"Error occurred in LeaveBalance checkForProvisioned with list title "+We.LeaveBalanceListName,data:e}),[3,3];case 3:return[2,!1]}})})},e.prototype.ensureProvisioned=function(){return Ze(this,void 0,void 0,function(){var e,t;return $e(this,function(n){switch(n.label){case 0:return[4,this.checkProvisioned()];case 1:if(n.sent())return[3,12];p.log({level:1,message:"LeaveBalance ensureProvisioned - provisioning list "+We.LeaveBalanceListName}),n.label=2;case 2:return n.trys.push([2,10,,11]),e={OnQuickLaunch:!1},[4,this.sp.web.lists.add(We.LeaveBalanceListName,We.LeaveBalanceListDescription,100,!1,e)];case 3:return n.sent(),[4,this.checkProvisioned()];case 4:return n.sent()?[4,this.list.fields.addChoice(We.LeaveBalanceFieldType,{EditFormat:Ge.Dropdown,FillInChoice:!1,Choices:[Ke.Annual,Ke.Sick,Ke.Parental,Ke.Family,Ke.CommunityService,Ke.LongService]})]:[3,8];case 5:return n.sent(),[4,this.list.fields.addText(We.LeaveBalanceFieldUser)];case 6:return n.sent(),[4,this.list.fields.addNumber(We.LeaveBalanceFieldBalance)];case 7:n.sent(),n.label=8;case 8:return[4,this.ensureSampleData()];case 9:return n.sent(),[2,!0];case 10:return t=n.sent(),p.log({level:3,message:"Error occurred in LeaveBalance ensureProvisioned with list title "+We.LeaveBalanceListName,data:t}),[3,11];case 11:return[2,!1];case 12:return[2,!0]}})})},e.prototype.ensureSampleData=function(){return Ze(this,void 0,void 0,function(){var e,t;return $e(this,function(n){switch(n.label){case 0:return[4,this.checkProvisioned()];case 1:if(!n.sent())return[3,7];n.label=2;case 2:return n.trys.push([2,6,,7]),[4,this.list.items.top(1)()];case 3:return 0!==n.sent().length?[3,5]:[4,this.list.items.add((t={Title:this.context.pageContext.user.loginName+"-"+Ke.Annual},t[We.LeaveBalanceFieldUser]=this.context.pageContext.user.loginName,t[We.LeaveBalanceFieldType]=Ke.Annual,t[We.LeaveBalanceFieldBalance]=70.2,t))];case 4:n.sent(),n.label=5;case 5:return[3,7];case 6:return e=n.sent(),p.log({level:3,message:"Error occurred in LeaveBalance ensureSampleData with list title "+We.LeaveBalanceListName,data:e}),[2,!1];case 7:return[2,!1]}})})},e.prototype.getLeaveBalance=function(e,t){return Ze(this,void 0,void 0,function(){var n,a;return $e(this,function(i){switch(i.label){case 0:return[4,this.checkProvisioned()];case 1:return i.sent()?[3,3]:(p.log({level:2,message:"LeaveBalance getLeaveBalance - list not provisioned"}),[4,this.ensureProvisioned()]);case 2:i.sent(),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,this.list.items.filter(We.LeaveBalanceFieldUser+" eq '"+e+"' and "+We.LeaveBalanceFieldType+" eq '"+t+"'").select(We.LeaveBalanceFieldBalance)()];case 4:return 0!==(n=i.sent()).length?[2,n[0][We.LeaveBalanceFieldBalance]]:(p.log({level:2,message:"LeaveBalance getLeaveBalance - record for user "+e+" doesn't exist"}),[3,6]);case 5:return a=i.sent(),p.log({level:3,message:"Error occurred in LeaveBalance getLeaveBalance with username "+e+" and type "+t,data:a}),[3,6];case 6:return[2,0]}})})},e}(),tt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),nt="LeaveRequest_CARD_VIEW",at="LeaveRequest_QUICK_VIEW",it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tt(t,e),t.prototype.onInit=function(){return e=this,void 0,n=function(){var e,t,n,a,i;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(r){switch(r.label){case 0:return p.subscribe(new d("LeaveRequestAdaptiveCardExtension",void 0)),p.activeLogLevel=0,this.state={loading:!0,submitting:!1,submitted:!1},this.cardNavigator.register(nt,function(){return new s}),this.quickViewNavigator.register(at,function(){return new Xe}),e=new et(this.context),t=this.setState,i={},[4,e.getLeaveBalance(this.context.pageContext.user.loginName,Ke.Annual)];case 1:return t.apply(this,[(i.annualLeaveBalance=r.sent(),i)]),[4,new Ye(this.context).getLeaveRequests(this.context.pageContext.user.loginName,Ke.Annual,!1)];case 2:return(n=r.sent())&&(a=0,n.forEach(function(e){a+=e.calculatedHours}),this.setState({unnapprovedAnnualLeaveBalance:a})),this.setState({loading:!1}),[2,Promise.resolve()]}})},new((t=void 0)||(t=Promise))(function(a,i){function r(e){try{s(n.next(e))}catch(e){i(e)}}function o(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(r,o)}s((n=n.apply(e,[])).next())});var e,t,n},t.prototype.loadPropertyPaneResources=function(){var e=this;return n.e(0).then(n.bind(null,"rrZa")).then(function(t){e._deferredPropertyPane=new t.LeaveRequestPropertyPane})},t.prototype.renderCard=function(){return nt},t.prototype.getPropertyPaneConfiguration=function(){return this._deferredPropertyPane.getPropertyPaneConfiguration()},t}(i.BaseAdaptiveCardExtension);t.default=it}})});